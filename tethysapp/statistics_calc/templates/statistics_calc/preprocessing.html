{% extends "statistics_calc/base.html" %}

{% block app_content %}

  <div class="jumbotron jumbotron-fluid">
    <h1>Process a Dataset</h1>
    <p>
      This page is for preprocessing a single dataset before merging it. You can view, interpolate, time scale,
      and download the preprocessed data here so that it can be used in the merge data page.
    </p>
  </div>

  <form id="pps_form" name="pps_form" method="post" enctype="multipart/form-data"
        action="/apps/statistics-calc/pps_csv/">
    {% csrf_token %}

    <h2 id="h2_raw_data_checks">Raw Data Checks</h2>
    <hr>

    <h3>File Upload (CSV)</h3>

    {# File Input Button #}
    <div class="input-group" id="csv_file_upload">
      <label class="input-group-btn">
            <span class="btn btn-default waves-effect waves-light">
            CSV File Upload<input type="file" name="pps_csv" id="pps_csv" style="display: none;">
            </span>
      </label>
      <input type="text" id="pps_csv_name" class="form-control is-invalid" readonly="">
    </div>

    <div id="validate_csv"></div>

    <br>

    <button class="btn btn-success" id="raw_data_plot_button">Analyze Raw Data</button>

    <div id="raw_data_plot">{# The Hydrograph goes here #}</div>
    <div id="raw_data_results">{# Table of Information Regarding Raw Data Goes Here #}</div>

    <br>

    <h2 id="h2_preprocessing">Preprocessing</h2>
    <hr>

    <h3>Interpolation Type</h3>

    <div class="pretty p-default p-curve p-smooth">
      <input type="radio" name="interp_method" value="linear" checked>
      <div class="state p-success">
        <label>Linear Interpolation</label>
      </div>
    </div>

    <div class="pretty p-default p-curve p-smooth">
      <input type="radio" name="interp_method" value="pchip">
      <div class="state p-success">
        <label>PCHIP Interpolation</label>
      </div>
    </div>

    <div class="pretty p-default p-curve p-smooth">
      <input type="radio" name="interp_method" value="cubic">
      <div class="state p-success">
        <label>Cubic Interpolation</label>
      </div>
    </div>

    <br><br>

    <h3>Interpolation Frequency (Leave both values at zero if you do not wish to interpolate)</h3>

    <div class="interpolation_frequencies">
      <label for="interp_hours">Hours:</label>
      <span id="interp_hours_value" style="font-weight:bold;color:red">0</span>
      <input type="range" min="0" max="24" value="0" class="slider" id="interp_hours" name="interp_hours">

      <br>

      <label for="interp_minutes">Minutes:</label>
      <span id="interp_minutes_value" style="font-weight:bold;color:red">0</span>
      <input type="range" min="0" max="45" step="15" value="0" class="slider" id="interp_minutes"
             name="interp_minutes">

    </div>

    <br>

    <h3>Time Range</h3>

    <h4>
      Do you want to timescale this data?
    </h4>

    <input type="checkbox" id="time_range_bool" data-toggle="toggle" data-on="Yes" data-off="No"
           data-onstyle="success" data-offstyle="danger" data-size="small">

    <br><br>

    <div id="time_range_inputs" style="display: none;">

      <label>Time Range</label>
      <div class="input-group input-daterange" id="timerange_input_box">
        <input type="text" class="form-control" name="begin_date" id="begin_date">
        <div class="input-group-addon">to</div>
        <input type="text" class="form-control" name="end_date" id="end_date">
      </div>

    </div>

    <div id="validation_error_time"></div>

    <br>

    <button class="btn btn-success waves-effect waves-light" id="generate_plot">Generate Plot</button>
    <button class="btn btn-success waves-effect waves-light" id="csv_button">Download CSV</button>

    <div id="pps_hydrograph"><!-- The Hydrograph goes here --></div>

  </form>

  <br>



{% endblock %}