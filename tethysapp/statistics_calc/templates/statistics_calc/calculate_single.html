{% extends "statistics_calc/base.html" %}
{% load tethys_gizmos %}
{% load tethys_gizmos staticfiles %}

{% block styles %}
    {{ block.super }}
    <link href="{% static 'statistics_calc/css/calculate_single.css' %}" rel="stylesheet"/>
{% endblock %}

{% block app_content %}

<div class="jumbotron jumbotron-fluid">
    <h1>Single Stream Analyzer</h1>
</div>

<!--data upload form-->
<form id="csv-upload" name="csv-upload" method="post" enctype="multipart/form-data">
        {% csrf_token %}

        <h2>Data Upload</h2><hr>

        <h3>Observed Data</h3>
          <div class="form-row">
            <div class="form-group col-md-2">
              <label for="observed_units">Units</label>
              <input type="checkbox" name="observed_units" data-toggle="toggle"
                                        data-on="SI" data-off="BG" data-onstyle="success" data-offstyle="primary"
                                        data-size="small" id="observed_units" checked>
            </div>
            <div class="form-group col-md-10">
              <label for="observed_csv">File Upload (CSV):</label>
              <label class="btn btn-default btn-file">
                <input type="file" name="observed_csv" id="observed_csv" multiple>
            </label>
            </div>
          </div>

        <h3>Simulated Data</h3>


            <!--Making a radio box option to either upload their own data or use the SFPT forecast historical data-->
            <div class="btn-group" data-toggle="buttons">
                <label class="btn btn-default form-check-label waves-effect waves-light">
                    <input class="form-check-input" type="radio" autocomplete="off"
                           name="predicted_radio" value="upload">
                    <h4>Upload Predicted Data (CSV):</h4>
                </label>
                <label class="btn btn-default form-check-label waves-effect waves-light">
                    <input class="form-check-input" type="radio" autocomplete="off"
                           name="predicted_radio" value="sfpt">
                    <h4>Use Streamflow Prediction Tool Historical Data:</h4>
                </label>
            </div>

            <br><br>
            <!--Form for uploading simulated data-->
            <div class="desc" id="upload">
                <div class="form-row">
                    <div class="form-group col-md-2">
                      <label for="simulated_units">Units</label>
                      <input type="checkbox" name="simulated_units_upload" data-toggle="toggle"
                                                data-on="SI" data-off="BG" data-onstyle="success" data-offstyle="primary"
                                                data-size="small" checked>
                    </div>
                    <div>
                        <div class="form-group col-md-10">
                            <label for="observed_csv">File Upload (CSV):</label>
                            <label class="btn btn-default btn-file">
                                <input type="file" name="observed_csv" multiple>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!--Form for using the streamflow prediction tool data-->
            <div class="desc" id="sfpt">
                <div class="form-row">
                    <div class="form-group col-md-2">
                      <label for="simulated_units">Units</label>
                      <input type="checkbox" name="simulated_units_sfpt" data-toggle="toggle"
                             data-on="SI" data-off="BG" data-onstyle="success" data-offstyle="primary"
                             data-size="small" id="simulated_units" checked>
                    </div>
                    <div>
                        <div class="form-group col-md-4">
                            <label for="sfpt_watershed">Reach ID:</label>
                            <input type="number" value=1 name="sfpt_watershed" id="sfpt_watershed"
                                   class="form-control">

                        </div>
                    </div>
                    <div>
                        <div class="form-group col-md-6">
                            <label for="simulated_watershed">Watershed:</label>
                            <select id="select_watershed" name="watershed" id="simulated_watershed"
                                    class="form-control">
                                {% for choice in watersheds %}
                                <option value="{{ choice }}">{{ choice }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <!--{% if not watershed_error %}-->
            <!--<label id="reach_id" style="display:none">Reach ID: <input ></label>-->
            <!--<select id="select_watershed" name="watershed" style="display:none">-->
            <!--</select>-->
            <!--{% else %}-->
                <!--<label id="reach_id" style="display:none"><p style="color:red">There is a problem calling the API for-->
                    <!--the watershed names, we are working to fix this. Please come back later.</p></label>-->
            <!--{% endif %}-->

        <hr>


    <h2>Visualization</h2>
        <h3>Plot of Entire Time Series:</h3>
            {% for plot in list_of_plots|slice:":5" %}
                <h4>
                    -{{ plot }}: <input type="checkbox" name="{{ plot }}" data-toggle="toggle" data-on="Yes" data-off="No"
                                        data-onstyle="success" data-offstyle="danger" data-size="small">
                </h4>
            {% endfor %}
        <h3>Plot of Daily Averages:</h3>
            {% for plot in list_of_plots|slice:"5:" %}
                <h4>
                    -{{ plot }}: <input type="checkbox" name="{{ plot }}_daily_average" data-toggle="toggle"
                                        data-on="Yes" data-off="No" data-onstyle="success" data-offstyle="danger"
                                        data-size="small">
                </h4>
            {% endfor %}

    <h2>Table</h2><hr>

        <h3>When calculating metrics, would you like to:</h3>
            Remove Negative Values?&nbsp;<input type="checkbox" name="remove_neg_bool" data-toggle="toggle"
                                                data-on="Yes" data-off="No" data-onstyle="success"
                                                data-offstyle="danger" data-size="mini">
            <br><br>
            Remove Zero Values?&nbsp;<input type="checkbox" name="remove_zero_bool" data-toggle="toggle" data-on="Yes"
                                            data-off="No" data-onstyle="success" data-offstyle="danger"
                                            data-size="mini">

        <h3>Select the Metrics to Include in the Table:</h3>

        <!--Displaying all of the metrics for the user to select-->
    <div class="ex1">
        {% for name_abbr in metric_loop_list %}
            {% if forloop.counter0 == 7 %}
                <label>
                    {{ name_abbr.0 }}: <input type="checkbox" id="{{ name_abbr.1 }}"
                                              name="{{ name_abbr.1 }}" onclick="myFunction()">
                </label>

                <label id="{{ name_abbr.1 }}_label" style="display:none">
                    M = <input type="number" name="mase_m" min="0" max="100" step=".1" value="1"> (Non-Seasonal = 1)
                </label>
        <br>

            {% elif forloop.counter0 == 18 %}
                <label>
                    {{ name_abbr.0 }}: <input type="checkbox" id="{{ name_abbr.1 }}"
                                              name="{{ name_abbr.1 }}" onclick="myFunction()">
                </label>

                <label id="{{ name_abbr.1 }}_label" style="display:none">
                    J = <input type="number" name="dmod_j" min="0" max="100" step=".1" value="1"> (Default = 1)
                </label>
        <br>

        {% elif forloop.counter0 == 22 %}
                <label>
                    {{ name_abbr.0 }}: <input type="checkbox" id="{{ name_abbr.1 }}"
                                              name="{{ name_abbr.1 }}" onclick="myFunction()">
                </label>

                <label id="{{ name_abbr.1 }}_label" style="display:none">
                    J = <input type="number" name="nse_mod_j" min="0" max="100" step=".1" value="1"> (Default = 1)
                </label>
        <br>

        {% elif forloop.counter0 == 24 %}
                <label>
                    {{ name_abbr.0 }}: <input type="checkbox" id="{{ name_abbr.1 }}"
                                              name="{{ name_abbr.1 }}" onclick="myFunction()">
                </label>

                <label id="{{ name_abbr.1 }}_label" style="display:none">
                    x&#772;' = <input type="number" name="lm_x_bar"
                                      min="0" max="1000000" step=".01" value="1"> (Default = x&#772;)
                </label>
        <br>

        {% elif forloop.counter0 == 44 %}
                <label>
                    {{ name_abbr.0 }}: <input type="checkbox" id="{{ name_abbr.1 }}"
                                              name="{{ name_abbr.1 }}" onclick="myFunction()">
                </label>

                <label id="{{ name_abbr.1 }}_label" style="display:none">
                    k = <input type="number" name="h6_k_MHE" min="0" max="100" step=".1" value="1"> (Default = 1)
                </label>
        <br>

        {% elif forloop.counter0 == 45 %}
                <label>
                    {{ name_abbr.0 }}: <input type="checkbox" id="{{ name_abbr.1 }}"
                                              name="{{ name_abbr.1 }}" onclick="myFunction()">
                </label>

                <label id="{{ name_abbr.1 }}_label" style="display:none">
                    k = <input type="number" name="h6_k_AHE" min="0" max="100" step=".1" value="1"> (Default = 1)
                </label>
        <br>

        {% elif forloop.counter0 == 46 %}
                <label>
                    {{ name_abbr.0 }}: <input type="checkbox" id="{{ name_abbr.1 }}"
                                              name="{{ name_abbr.1 }}" onclick="myFunction()">
                </label>

                <label id="{{ name_abbr.1 }}_label" style="display:none">
                    k = <input type="number" name="h6_k_RMSHE" min="0" max="100" step=".1" value="1"> (Default = 1)
                </label>
        <br>

        {% elif forloop.counter0 == 65 %}
                <label>
                    {{ name_abbr.0 }}: <input type="checkbox" id="{{ name_abbr.1 }}"
                                              name="{{ name_abbr.1 }}" onclick="myFunction()">
                </label>

                <label id="{{ name_abbr.1 }}_label" style="display:none">
                    x&#772;' = <input type="number" name="d1_p_x_bar"
                                      min="0" max="1000000" step=".01" value="1"> (Default = x&#772;)
                </label>
        <br>

        {% else %}
                <label>
                    {{ name_abbr.0 }}: <input type="checkbox" id="{{ name_abbr.1 }}" name="{{ name_abbr.1 }}"></label>
                <br>
        {% endif %}
        {% endfor %}

    </div><br>
</form>

    <button type="button" class="btn btn-success" onclick="createTable()">Make Table</button><br><br>

    <div id="table"></div> <!-- The table or errors go here -->

    <hr>

        <!--Optional: Date Range-->
        <h3>Include Analysis of Date Range(s) in Table? <input type="checkbox"
                                                               name="date_range_bool"
                                                               id="date_range_bool"
                                                               onclick="myFunction()"></h3>

            <!--begin date-->
            <label id="date_range_form" style="display:none">
                <h4>How many Date Ranges Would You Like to Analyze?
                    <input type="number" id="Num_of_Date_Ranges" min="0" max="100"
                           step="1" value="0" oninput="addFields()">
                    <!--<a href="javascript:void(0);" id="fill_date_ranges" onclick="addFields()">Add Date Range Forms</a>-->
                    <div id="date_range_container"></div></h4>
            </label>

</form>

    <!--<h2>Volume</h2>-->
        <!--<h3>Create Table of Streamflow Volumes? <input type="checkbox" name="volume_table"></h3>-->

<!--<button type=submit class="btn btn-success">Submit</button>-->

{% endblock %}
